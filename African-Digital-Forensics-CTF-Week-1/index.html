<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="African Digital Forensics CTF - Week 1" /><meta name="author" content="mooncakeza" /><meta property="og:locale" content="en" /><meta name="description" content="The United Nations Cybercrime unit in Africa, lead by Carmen Corbin_UN created a unique Digital Forensics CTF competition for the month of May for Africa in the digital forensics cybersecurity field and for people who are keen to see how their skills are. I for one do not work in the digital forensics field so I wanted to see how I would do in this but having worked as a systems administrator for most of my career, and now trying to make a move into offensive / forensics security, I had an idea on what things to look for, etc." /><meta property="og:description" content="The United Nations Cybercrime unit in Africa, lead by Carmen Corbin_UN created a unique Digital Forensics CTF competition for the month of May for Africa in the digital forensics cybersecurity field and for people who are keen to see how their skills are. I for one do not work in the digital forensics field so I wanted to see how I would do in this but having worked as a systems administrator for most of my career, and now trying to make a move into offensive / forensics security, I had an idea on what things to look for, etc." /><link rel="canonical" href="https://0x.3n0.us/African-Digital-Forensics-CTF-Week-1/" /><meta property="og:url" content="https://0x.3n0.us/African-Digital-Forensics-CTF-Week-1/" /><meta property="og:site_name" content="0x3n0" /><meta property="og:image" content="https://0x.3n0.us/assets/img/ctf/dfir/cybercrime-logo.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-02T17:00:00+07:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://0x.3n0.us/assets/img/ctf/dfir/cybercrime-logo.png" /><meta property="twitter:title" content="African Digital Forensics CTF - Week 1" /><meta name="twitter:site" content="@0x3n0" /><meta name="twitter:creator" content="@mooncakeza" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"mooncakeza"},"dateModified":"2022-01-07T15:01:48+07:00","datePublished":"2021-06-02T17:00:00+07:00","description":"The United Nations Cybercrime unit in Africa, lead by Carmen Corbin_UN created a unique Digital Forensics CTF competition for the month of May for Africa in the digital forensics cybersecurity field and for people who are keen to see how their skills are. I for one do not work in the digital forensics field so I wanted to see how I would do in this but having worked as a systems administrator for most of my career, and now trying to make a move into offensive / forensics security, I had an idea on what things to look for, etc.","headline":"African Digital Forensics CTF - Week 1","image":"https://0x.3n0.us/assets/img/ctf/dfir/cybercrime-logo.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://0x.3n0.us/African-Digital-Forensics-CTF-Week-1/"},"url":"https://0x.3n0.us/African-Digital-Forensics-CTF-Week-1/"}</script> <script src="//darksec.or.id/comments/dist/Valine.min.js"></script><title>African Digital Forensics CTF - Week 1 | 0x3n0</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="0x3n0"><meta name="application-name" content="0x3n0"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">0x3n0</a></div><div class="site-subtitle font-italic">Researcher | Pentester</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/Whoami/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>WHOAMI</span> </a><li class="nav-item"> <a href="/revershell/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>REVERSHELL</span> </a><li class="nav-item"> <a href="/OSINT/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>OSINT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://twitter.com/0x3n0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/0x3n0" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://instagram.com/0x3n0" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://app.hackthebox.com/profile/381523" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>African Digital Forensics CTF - Week 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>African Digital Forensics CTF - Week 1</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> mooncakeza </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Jun 2, 2021, 5:00 PM +0700" >Jun 2, 2021<i class="unloaded">2021-06-02T17:00:00+07:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Jan 7, 2022, 5:01 PM +0900" >Jan 7<i class="unloaded">2022-01-07T15:01:48+07:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1741 words">9 min read</span></div></div><div class="post-content"><p>The <a href="https://twitter.com/UN__Cyber">United Nations Cybercrime unit</a> in Africa, lead by <a href="https://twitter.com/CarmenCorbin_UN">Carmen Corbin_UN</a> created a unique Digital Forensics CTF competition for the month of May for Africa in the digital forensics cybersecurity field and for people who are keen to see how their skills are. I for one do not work in the digital forensics field so I wanted to see how I would do in this but having worked as a systems administrator for most of my career, and now trying to make a move into offensive / forensics security, I had an idea on what things to look for, etc.</p><p>This challenge was created by <a href="https://twitter.com/dfirscience">DFIR.Science</a>. This was unique in a way that you had to complete 4 weeks of challenges and also try to complete the challenges before other people did. I was excited. <br /></p><ul><li>Week 1 you were given a suspect disk to analyze. <br /><li>Week 2 you were given a memory dump of the suspect disk. <br /><li>Week 3 you were given a network dump of the suspect computer. <br /><li>Week 4 you were given a dump of the android phone of the suspect.</ul><p>For me, having a full time job, I couldn’t spend every minute of the day trying to do the challenges and seeing people finish challenges before you could even attempt them was disheartening, but I told myself, this is all about learning and the scoreboard should mean nothing.</p><p>I only saw the CTF on the 6 May, thanks to seeing a post by <a href="https://twitter.com/Ms_R00T">Ms_R00T</a>, so she needs a shout!</p><p>So let me start with the writeup for week 1.</p><h1 id="week-1">Week 1</h1><p>So we were given a Forensic Disk Image which we had to download. Once downloaded, we used an application called <a href="https://www.autopsy.com/">Autopsy</a> to load the disk image so that we could access the data on it.</p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 data.png" alt="week1" /></p><p>We were given 11 questions to answer ranging from 3 points to 12. This is how I solved week 1.</p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 tasks.png" alt="week1" /></p><h3 id="1-deleted">1) Deleted</h3><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 Deleted.png" alt="week1" /></p><p>This task was pretty straight forward. When files get deleted on windows, it goes to the <b>Recycle Bin</b>. I went straight to the location of the <b>Recycle Bin</b> to check what files were deleted.</p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/1.0 recyclebin.png" alt="week1" /></p><p>There was only one file in there so we can easily see that it’s the intended file and we can see the date and time it was deleted.</p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/1.1 deleted.png" alt="week1" /></p><h3 id="2-server-connection">2) Server Connection</h3><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 Server Connection.png" alt="week1" /></p><p>Here I went to the <b>Installed Programs</b> to see what FTP clients were installed and I saw that <b>Filezilla Client</b> was there.</p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/2.1 installed programs.png" alt="week1" /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/2.2 filezilla.png" alt="week1" /></p><p>I have used <b>Filezilla Client</b> before so I knew exactly where to go look on the system and see potential connections in the <b>filezilla.xml</b> When a user saves connections for FTP, SFTP, etc in Filezilla, it will save it in that file.</p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/2.3 filezilla folder.png" alt="week1" />i</p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/2.4 filezilla IP.png" alt="week1" /></p><h3 id="3-suspect-disk-hash">3) Suspect Disk Hash</h3><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 Suspect Disk Hash.png" alt="week1" /></p><p>For this one I first did it another method but 3 weeks later I cannot remember what I did. I think I used another tool on linux to check this but when I went through these challenges again to do the writeup I totally forgot. <br /> Anyways, for this you can simply download a program called <a href="https://accessdata.com/products-services/forensic-toolkit-ftk/ftkimager">FTK Imager</a> Once installed you just import the disk image as below and you will find the MD5 hash.</p><p>Click <b>file</b> and then <b>Add Evidence Item</b></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/3.1 FKT add item.png" alt="week1" /> <br /> Select <b>Image File</b> <br /> <img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/3.2 image file.png" alt="week1" /> <br /> Then browse and select the <b>001Win10.E01</b> <br /> <img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/3.3 add image.png" alt="week1" /> <br /> Once imported on the left, right click on the <b>001Win10.E01</b> and select <b>Verify Drive/Image</b> <br /> <img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/3.4 image verify.png" alt="week1" /> <br /> It will start to verify. <br /> <img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/3.5 verifying image.png" alt="week1" /> <br /> Now we can see the hash. <br /> <img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/3.6 verified hash.png" alt="week1" /></p><h3 id="4-web-search">4) Web Search</h3><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 Web Search.png" alt="week1" /></p><p>This one was fairly simple as we just go look under the <b>Web History</b> and go to the time in the question and you will find the search term used.</p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/4.1 Web History.png" alt="week1" /> <br /> <img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/4.2 google search.png" alt="week1" /></p><h3 id="5-possible-location">5) Possible Location</h3><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 Possible Location.png" alt="week1" /></p><p>So this one for me was easy. You could just click on the <b>Geolocation</b> button on the toolbar at the top of Autopsy. This takes all the metadata on images on the system , looks for the GPS tags in them and pin points it on a world map. It found 2 countries but what if there are 10 or 20? So I did it the way I usually do and check the metadata on the image itself.</p><p>We first have to extract the image from the disk and then run a tool on the image. Find the image on the system and then right click on it to extract it to a location on your local system.</p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/5.1 Metadata Folder.png" alt="week1" /> <br /> <img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/5.2 Photo Location.png" alt="week1" /> <br /></p><p>Then I downloaded <a href="https://exiftool.org/">exiftool</a> and ran it against the image to get the metadata from it. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/5.3 exiftool.png" alt="week1" /> <br /></p><p>Towards the bottom we find the GPS location. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/5.4 GPS location.png" alt="week1" /> <br /></p><p>I went to a website called https://www.gps-coordinates.net/ and entered the GPS coordinates. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/5.5 location found.png" alt="week1" /></p><h3 id="6-tor-browser">6) Tor Browser</h3><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 Tor Browser.png" alt="week1" /></p><p>This one had me stumped for a while as I was back and forth making sure I wasn’t going crazy. I searched for the word <b>tor</b> and found the following <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/6.1 tor search.png" alt="week1" /> <br /> To confirm, I went to the location on the disk which was under the user’s Desktop folder.</p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/6.2 tor folder.png" alt="week1" /> <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/6.3 tor exe.png" alt="week1" /> <br /></p><p>After some researching on how to find out how many times a user has run a program, I came across windows <b>prefetch</b>.</p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/6.4 prefetch folder.png" alt="week1" /> <br /></p><p>From what I understand, this <b>prefetch folder</b> contains information about programs you run on the system. This might indicate how many times a program is run on the system. <br /> I searched for <b>tor.exe</b> in this folder but could not find anything. <br /> I only found a <b>torbrowser</b> prefetch file. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/6.5 tor install.png" alt="week1" /> <br /></p><p>Could it be that the user downloaded the tor browser installation and just installed it and then did not run the tor browser on the system yet? <br /> My conclusion was correct.</p><h3 id="7-user-email">7) User Email</h3><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 User Email.png" alt="week1" /> <br /></p><p>Autopsy has an <b>email address</b> folder but looking at it there was 5798 results. Definitly not gonna sif through that. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/7.1 email lots.png" alt="week1" /> <br /></p><p>So I browsed to the <b>Web Form Autofill</b> to see for potential usernames/emails in web form fields and we found something. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/7.2 web form.png" alt="week1" /> <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/7.3 username.png" alt="week1" /> <br /></p><p>Now I just went to the <b>keyword search</b> on the top right and searched for the username and after going through the results we find the email address. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/7.4 email.png" alt="week1" /></p><h3 id="8-web-scanning">8) Web Scanning</h3><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 Web Scanning.png" alt="week1" /> <br /> Now we go back to <b>Installed Programs</b> and find <b>Angry IP Scanner</b> and <b>Nmap</b></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/8.1 Installed Programs.png" alt="week1" /> <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/8.2 Angry IP Scanner.png" alt="week1" /> <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/8.3 NMAP.png" alt="week1" /> <br /></p><p>Having some basic powershell knowledge I immediatley thought to check the <b>ConsoleHost_history.txt</b> file for any commands run by the user. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/8.4 Console History.png" alt="week1" /> <br /></p><p>Yep, there it is. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/8.5 scanned website.png" alt="week1" /></p><h3 id="9-copy-location">9) Copy Location</h3><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 Copy Location.png" alt="week1" /></p><p>This one was a big trickyish. Getting the file on the disk was no problem but finding the original was going to take some digging. We go to <b>EXIF Metadata</b> and see that it was taken with a LG phone. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/9.1 exif metdata.png" alt="week1" /> <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/9.2 lg camera.png" alt="week1" /> <br /></p><p>We then do a <b>Keyword Search</b> for <b>20210429_151535.jpg</b>. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/9.3 keyword search.png" alt="week1" /> <br /></p><p>and then check the times when we scroll to the right. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/9.4 times.png" alt="week1" /> <br /></p><p>I right clicked on the file and selected <b>View Source File in Timeline</b> and chose <b>File Created</b> and set the time frame 10 minutes either way. <br /> For some reason when I tried to do this while writing the writeup it just did not want to play nice so I had to manually enter the time frame. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/9.5 filecreated time.png" alt="week1" /> <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/9.6 original image.png" alt="week1" /> <br /></p><p>So as we can see, the original image came from the LG camera device. <br /> Back to the main Autopsy window we go to <b>Shell Bags</b> on the left. <br /></p><p><b>ShellBags</b> are a popular artifact in Windows forensics often used to identify the existence of directories on local, network, and removable storage devices. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/9.7 shellbags.png" alt="week1" /> <br /></p><p>Now I cannot remember what the actual answer was but it was one of the following. If someone can let me know if you can find the proof. I think it could have been either <b>Camera</b> or <b>DCIM</b>. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/9.8 image location.png" alt="week1" /></p><h3 id="10-hash-cracker">10) Hash Cracker</h3><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 Hash Cracker.png" alt="week1" /> <br /></p><p>This one took a bit. We know this is a NTLM hash. For those that don’t know what a NTLM hash is let’s break it down. <br /> It is constructed into 4 parts <br /></p><ul><li>John Doe - the user name <br /><li>1001 - RID (relative identifier or user ID) <br /><li>aad3b435b51404eeaad3b435b51404ee - LM hash <br /><li>3DE1A36F6DDB8E036DFD75E8E20C4AF4 - NT hash <br /></ul><p>I took the following from <a href="https://chryzsh.gitbooks.io/darthsidious/content/getting-started/intro-to-windows-hashes.html"># Intro to Windows hashes</a> as I am too lazy to write it in my own words.</p><ul><li><b>LM</b> - The LM hash is used for storing passwords. It is disabled in W7 and above. However, LM is enabled in memory if the password is less than 15 characters. That’s why all recommendations for admin accounts are 15+ chars. LM is old, based on MD4 and easy to crack. The reason is that Windows domains require speed, but that also makes for shit security.<li><b>NT</b> - The NT hash calculates the hash based on the entire password the user entered. The LM hash splits the password into two 7-character chunks, padding as necessary.<li><b>NTLM</b> - The NTLM hash is used for local authentication on hosts in the domain. It is a combination of the LM and NT hash as seen above. <br /></ul><p>The only part we are going to use is the NT hash. <br /></p><p>We can check https://hashcat.net/wiki/doku.php?id=example_hashes to see what mode this is <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/11.7 hashcat mode.png" alt="week1" /> <br /></p><p>I ran this hash through rockyou.txt and found nothing. <br /> Let us use the <a href="https://github.com/NotSoSecure/password_cracking_rules">OneRuleToRuleThemAll</a> and see if we get anything. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/10.1 hash onerule rule.png" alt="week1" /> <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/10.2 hash cracked.png" alt="week1" /></p><h3 id="11-user-password">11) User Password</h3><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/week1 user Password.png" alt="week1" /> <br /> So for this one we needed to understand where Windows stores a user’s password hash. On linux it is simple, it stores it in the /etc/shadow file. In Windows you require two files. <br /> One is the <b>SAM</b> file, this stores the Windows user hashes but these hashes are encrypted with the <b>SYSTEM </b>file. <br /> So in order for us to crack the hashes, we need both of these file on the Windows system. <br /> Let’s go grab them. <br /> <br /> Click on the <b>Operating System Information</b> on the left <br /> <img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/11.1 SYSTEM file.png" alt="week1" /> <br /> and then right click the <b>SYSTEM</b> file and extract it to your local machine. <br /> <img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/11.2 SYSTEM extract.png" alt="week1" /> <br /> Click on the <b>Operating System User Account</b> on the left <br /> <img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/11.3 SAM file.png" alt="week1" /> <br /> And then right click the <b>SAM</b> file for <b>John Doe</b> and extract it to your local machine. <br /> <img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/11.4 SAM extract.png" alt="week1" /> <br /></p><p>I copied both SYSTEM and SAM file to my Kali machine. <br /> I used a tool called pwdump which can be installed with the <a href="https://github.com/CiscoCXSecurity/creddump7">creddump7</a> package. <br /> creddump7 is in the Kali repository already thus pwdump was already available on my Kali machine. <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/11.5 users hash.png" alt="week1" /> <br /></p><p>We only need the John Doe NT hash as explained in the previous challenge. <br /> I used same method with the same rule for hashcat <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/11.9 hashcat start.png" alt="week1" /> <br /></p><p><img data-proofer-ignore data-src="/assets/img/ctf/dfir/week1/11.10 hash cracked.png" alt="week1" /> <br /> <br /></p><h3 id="conclusion">Conclusion</h3><p>Week 1 was done and I enjoyed it tons! I had never used Autopsy before so this was a great way to learn it! <br /> If you do see any mistakes, spelling, grammer, formatting, please let me know. I tried to do the best I could with this writeup but I am sure I might have done some mistakes :) <br /> <br /> <b>Stay tuned for week 2 write up in the next few days</b></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeup/'>writeup</a>, <a href='/categories/dfir/'>dfir</a>, <a href='/categories/forensics/'>forensics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/dfir/" class="post-tag no-text-decoration" >dfir</a> <a href="/tags/forensics/" class="post-tag no-text-decoration" >forensics</a> <a href="/tags/digital-forenics/" class="post-tag no-text-decoration" >digital forenics</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://0x3n0.us"> 0x3n0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=African Digital Forensics CTF - Week 1 - 0x3n0&url=https://0x.3n0.us/African-Digital-Forensics-CTF-Week-1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=African Digital Forensics CTF - Week 1 - 0x3n0&u=https://0x.3n0.us/African-Digital-Forensics-CTF-Week-1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=African Digital Forensics CTF - Week 1 - 0x3n0&url=https://0x.3n0.us/African-Digital-Forensics-CTF-Week-1/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://0x.3n0.us/African-Digital-Forensics-CTF-Week-1/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="http://service.weibo.com/share/share.php?title=African Digital Forensics CTF - Week 1 - 0x3n0&url=https://0x.3n0.us/African-Digital-Forensics-CTF-Week-1/" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <a href="https://lineit.line.me/share/ui?url=https://0x.3n0.us/African-Digital-Forensics-CTF-Week-1/&text=African Digital Forensics CTF - Week 1 - 0x3n0" data-toggle="tooltip" data-placement="top" title="Line" target="_blank" rel="noopener" aria-label="Line"> <i class="fa-fw iconfont icon-13"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/lack-of-resources-&-rate-limiting/">OWASP API Security Lack of Resources & Rate Limiting</a><li><a href="/cyberwarfare/">The invisible war</a><li><a href="/Postman-Writeup/">Postman Writeup</a><li><a href="/Traverxec-Writeup/">Traverxec Writeup</a><li><a href="/Resolute-Writeup/">Resolute Writeup</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/oscp-prep/">oscp-prep</a> <a class="post-tag" href="/tags/htb-linux-easy/">htb-linux-easy</a> <a class="post-tag" href="/tags/htb-windows-easy/">htb-windows-easy</a> <a class="post-tag" href="/tags/reverse-shell/">reverse-shell</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/programming/">Programming</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div class="post-navigation d-flex justify-content-between"> <a href="/FunboxEasyEnum-Writeup/" class="btn btn-outline-primary" prompt="Older"><p>FunboxEasyEnum Writeup</p></a> <a href="/African-Digital-Forensics-CTF-Week-2/" class="btn btn-outline-primary" prompt="Newer"><p>African Digital Forensics CTF - Week 2</p></a></div><div id="vcomments"></div><script> new Valine({ el: '#vcomments', appId: 'FWkEX16hdTMRmYzFQeIqS4GH-MdYXbMMI', appKey: 'ihjgIDYfMOWOfiX7hkrQrGXR', placeholder:'Your Comments.', avatar: 'wavatar', lang: 'en', enableQQ: true }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"> <a href="https://twitter.com/0x3n0?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-size="large" data-dnt="true" data-show-count="false">Follow @0x3n0</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><script src="https://www.hackthebox.com/badge/381523"></script></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/oscp-prep/">oscp prep</a> <a class="post-tag" href="/tags/htb-linux-easy/">htb linux easy</a> <a class="post-tag" href="/tags/htb-windows-easy/">htb windows easy</a> <a class="post-tag" href="/tags/reverse-shell/">reverse shell</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/programming/">Programming</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
