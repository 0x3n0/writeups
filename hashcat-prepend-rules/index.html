<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="hashcat prepend rules the hard way" /><meta name="author" content="mooncakeza" /><meta property="og:locale" content="en" /><meta name="description" content="So on a recent CTF challenge I had to crack a hash which proved to be a bit challenging. I have always cracked hashes with dictionaries like the famous rockyou.txt. That&#39;s the problem with most CTFs, most are not real world scenarios. Now this CTF was a bit different. It required more than just a dictionary. It required you to either use masking or rules against dictionaries. But of course I first ran it through rockyou.txt (14 million passwords) and I even ran it through another password file, weakpass_2a (7.8 billion passwords) and guess what, it didn’t crack the hash. Next step was to pretty much bruteforce it. hashcat has a bruteforce mode where you can throw every character at it to try crack it. The problem is, the longer the word, the longer it takes to crack. Another factor is, hashcat uses either youir CPU or GPU, so the power you have also inluences the cracking speed. I am not going to go into detail with this but this is something to keep in mind. Passwords are compromised of either uppercase, lowercase, digits, special characters or other different charsets. Another thing is the length of the password. So taking this into account you have to pretty much figure out how to attack it. One of the easiest, but costly ways is to use all charsets. These charsets correspond with the following masks in hashcat: 1 2 3 4 5 ?l - lowercase alphabet [a-z] ?u - uppercase alphabet [A-Z] ?d - digits [0-9] ?s - special characters ?a - all characters So let’s look at the following: You want to crack a hash but you have no idea on how many characters are in it or what characters they are. We can use the all characters mask but do keep in mind that the more you try the longer it will take. I usually can only do 5 due to my hardware resources. 6 characters would take me a year to crack. For this I could use the following command to try brute forcing from 1 character to 5 character password. (You can set the max increment value to what you want but remember it will take much longer the higher you go) 1 hashcat -m 1000 -a 3 password.hash -i --increment-min 1 --increment-max 5 ?a?a?a?a?a? This would take me: 1 Time.Estimated...: Wed Jun 2 00:56:12 2021 (4 days, 3 hours) Not ideal and I have no idea how long the password is. Now the thing with this challenge was, I had no idea how long the password would be so I was trying all sorts of things with previous passwords from the CTF. Previous passwords were Afr1ca!, AfricanCTF2021 and ctf2021. So as you can see, there could be a pattern, so I tried a few mutations on those words but nothing came back. I hit a brickwall. A hint came out and it was basically said to use rules with dictionaries or masking. The masking was pretty much explained as, passwords usually start with an uppercase, ends with a ! and most times end with the 2nd last and 3rd last characters are lowercase and it seemed like it was hinted that the password was 8 characters long. So with that in mind, you could do the following mask: 1 hashcat -m 13600 -a 3 password.hash ?u?a?a?a?a?l?l! For me this would take a month to crack and this challenge only less than a week left! Back to the drawing board. Luckily, I knew someone, thanks NeonPegasus, with a beefy GPU so I asked them to throw it against that and see how long it would take to bruteforce. 1 (6 hours, 2 mins) I want that GPU! I wasn’t going to wait so I thought about this logically as a typical user and thought, what do we as humans do with passwords? We repeat passwords but just add or change a certain aspect of it. e.g Rover21April –&gt; Rover21May What if I used the same thinking to this challenge? Break down the passwords seen into smaller chunks, and from the hints given, prepend or append them to a dictionary? e.g Afr1can AfricanCTF2021 ctf2021 to Afr1can African CTF 2021 ctf So I did some reading and I found how to prepend and append these to another wordlist. Now before I embarrass myself, the method I used does work, to a certain degree, BUT because it kinda worked, I completely missed another attack mode that hashcat has to make this much simpler…but so we learn. Anyway, so I created a rules file to prepend them to rockyou.txt. My rules file looked like this: 1 2 3 4 5 ^n^a^c^1^r^f^A ^n^a^c^i^r^f^A ^f^t^c ^F^T^C ^1^2^0^2 It may look weird but this is how prepend works in hashcat. The char ^ is the prepend function. Say there is a word, dog, in the rockyou.txt file. You want to prepend the word cat to it. Your rule would look like ^t^a^c. So from left to right, hashcat will start with ^t and prepend it to dog making it tdog. The next one would be ^a and prepend that to tdog making it atdog. ^c prepends to atdog making it catdog. Done. Append works the other way. You have the word dog and you want to append cat to it. Your rule would be ^c^a^t, thus ^c appends to dog making it dogc, ^a appends to dogc making it dogca and finally ^t appends to dogca making it dogcat. Simple. So to use your rule file against a dictionary you would use the following: 1 hashcat -m 1000 -a 0 password.hash -r rule.file rockyou.txt So what I did was prepend the rules to rockyou.txt 1 2 Time.Estimated...: (56 mins, 9 secs) Status...........: Cracked I was baffled as to why I could not do words with the rules method so I took to our Hack South discord server and asked the question. With it being late Friday afternoon and a busy week behind me, someone mentioned why not just use the combinator attack. Wait what, how did I miss that, thanks Leon! So essentially I could have just put those words in a file and run: 1 hashcat -m 13600 -a 1 password.hash words.file rockyou.txt I felt stupid but then again, I actually learned how to do it the hard way and learned so much more about hashcat rules. ;-)" /><meta property="og:description" content="So on a recent CTF challenge I had to crack a hash which proved to be a bit challenging. I have always cracked hashes with dictionaries like the famous rockyou.txt. That&#39;s the problem with most CTFs, most are not real world scenarios. Now this CTF was a bit different. It required more than just a dictionary. It required you to either use masking or rules against dictionaries. But of course I first ran it through rockyou.txt (14 million passwords) and I even ran it through another password file, weakpass_2a (7.8 billion passwords) and guess what, it didn’t crack the hash. Next step was to pretty much bruteforce it. hashcat has a bruteforce mode where you can throw every character at it to try crack it. The problem is, the longer the word, the longer it takes to crack. Another factor is, hashcat uses either youir CPU or GPU, so the power you have also inluences the cracking speed. I am not going to go into detail with this but this is something to keep in mind. Passwords are compromised of either uppercase, lowercase, digits, special characters or other different charsets. Another thing is the length of the password. So taking this into account you have to pretty much figure out how to attack it. One of the easiest, but costly ways is to use all charsets. These charsets correspond with the following masks in hashcat: 1 2 3 4 5 ?l - lowercase alphabet [a-z] ?u - uppercase alphabet [A-Z] ?d - digits [0-9] ?s - special characters ?a - all characters So let’s look at the following: You want to crack a hash but you have no idea on how many characters are in it or what characters they are. We can use the all characters mask but do keep in mind that the more you try the longer it will take. I usually can only do 5 due to my hardware resources. 6 characters would take me a year to crack. For this I could use the following command to try brute forcing from 1 character to 5 character password. (You can set the max increment value to what you want but remember it will take much longer the higher you go) 1 hashcat -m 1000 -a 3 password.hash -i --increment-min 1 --increment-max 5 ?a?a?a?a?a? This would take me: 1 Time.Estimated...: Wed Jun 2 00:56:12 2021 (4 days, 3 hours) Not ideal and I have no idea how long the password is. Now the thing with this challenge was, I had no idea how long the password would be so I was trying all sorts of things with previous passwords from the CTF. Previous passwords were Afr1ca!, AfricanCTF2021 and ctf2021. So as you can see, there could be a pattern, so I tried a few mutations on those words but nothing came back. I hit a brickwall. A hint came out and it was basically said to use rules with dictionaries or masking. The masking was pretty much explained as, passwords usually start with an uppercase, ends with a ! and most times end with the 2nd last and 3rd last characters are lowercase and it seemed like it was hinted that the password was 8 characters long. So with that in mind, you could do the following mask: 1 hashcat -m 13600 -a 3 password.hash ?u?a?a?a?a?l?l! For me this would take a month to crack and this challenge only less than a week left! Back to the drawing board. Luckily, I knew someone, thanks NeonPegasus, with a beefy GPU so I asked them to throw it against that and see how long it would take to bruteforce. 1 (6 hours, 2 mins) I want that GPU! I wasn’t going to wait so I thought about this logically as a typical user and thought, what do we as humans do with passwords? We repeat passwords but just add or change a certain aspect of it. e.g Rover21April –&gt; Rover21May What if I used the same thinking to this challenge? Break down the passwords seen into smaller chunks, and from the hints given, prepend or append them to a dictionary? e.g Afr1can AfricanCTF2021 ctf2021 to Afr1can African CTF 2021 ctf So I did some reading and I found how to prepend and append these to another wordlist. Now before I embarrass myself, the method I used does work, to a certain degree, BUT because it kinda worked, I completely missed another attack mode that hashcat has to make this much simpler…but so we learn. Anyway, so I created a rules file to prepend them to rockyou.txt. My rules file looked like this: 1 2 3 4 5 ^n^a^c^1^r^f^A ^n^a^c^i^r^f^A ^f^t^c ^F^T^C ^1^2^0^2 It may look weird but this is how prepend works in hashcat. The char ^ is the prepend function. Say there is a word, dog, in the rockyou.txt file. You want to prepend the word cat to it. Your rule would look like ^t^a^c. So from left to right, hashcat will start with ^t and prepend it to dog making it tdog. The next one would be ^a and prepend that to tdog making it atdog. ^c prepends to atdog making it catdog. Done. Append works the other way. You have the word dog and you want to append cat to it. Your rule would be ^c^a^t, thus ^c appends to dog making it dogc, ^a appends to dogc making it dogca and finally ^t appends to dogca making it dogcat. Simple. So to use your rule file against a dictionary you would use the following: 1 hashcat -m 1000 -a 0 password.hash -r rule.file rockyou.txt So what I did was prepend the rules to rockyou.txt 1 2 Time.Estimated...: (56 mins, 9 secs) Status...........: Cracked I was baffled as to why I could not do words with the rules method so I took to our Hack South discord server and asked the question. With it being late Friday afternoon and a busy week behind me, someone mentioned why not just use the combinator attack. Wait what, how did I miss that, thanks Leon! So essentially I could have just put those words in a file and run: 1 hashcat -m 13600 -a 1 password.hash words.file rockyou.txt I felt stupid but then again, I actually learned how to do it the hard way and learned so much more about hashcat rules. ;-)" /><link rel="canonical" href="https://0x.3n0.us/hashcat-prepend-rules/" /><meta property="og:url" content="https://0x.3n0.us/hashcat-prepend-rules/" /><meta property="og:site_name" content="0x3n0" /><meta property="og:image" content="https://0x.3n0.us/assets/img/img/hashcat.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-31T09:30:00+07:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://0x.3n0.us/assets/img/img/hashcat.png" /><meta property="twitter:title" content="hashcat prepend rules the hard way" /><meta name="twitter:site" content="@0x3n0" /><meta name="twitter:creator" content="@mooncakeza" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"mooncakeza"},"dateModified":"2022-01-07T15:01:48+07:00","datePublished":"2021-05-31T09:30:00+07:00","description":"So on a recent CTF challenge I had to crack a hash which proved to be a bit challenging. I have always cracked hashes with dictionaries like the famous rockyou.txt. That&#39;s the problem with most CTFs, most are not real world scenarios. Now this CTF was a bit different. It required more than just a dictionary. It required you to either use masking or rules against dictionaries. But of course I first ran it through rockyou.txt (14 million passwords) and I even ran it through another password file, weakpass_2a (7.8 billion passwords) and guess what, it didn’t crack the hash. Next step was to pretty much bruteforce it. hashcat has a bruteforce mode where you can throw every character at it to try crack it. The problem is, the longer the word, the longer it takes to crack. Another factor is, hashcat uses either youir CPU or GPU, so the power you have also inluences the cracking speed. I am not going to go into detail with this but this is something to keep in mind. Passwords are compromised of either uppercase, lowercase, digits, special characters or other different charsets. Another thing is the length of the password. So taking this into account you have to pretty much figure out how to attack it. One of the easiest, but costly ways is to use all charsets. These charsets correspond with the following masks in hashcat: 1 2 3 4 5 ?l - lowercase alphabet [a-z] ?u - uppercase alphabet [A-Z] ?d - digits [0-9] ?s - special characters ?a - all characters So let’s look at the following: You want to crack a hash but you have no idea on how many characters are in it or what characters they are. We can use the all characters mask but do keep in mind that the more you try the longer it will take. I usually can only do 5 due to my hardware resources. 6 characters would take me a year to crack. For this I could use the following command to try brute forcing from 1 character to 5 character password. (You can set the max increment value to what you want but remember it will take much longer the higher you go) 1 hashcat -m 1000 -a 3 password.hash -i --increment-min 1 --increment-max 5 ?a?a?a?a?a? This would take me: 1 Time.Estimated...: Wed Jun 2 00:56:12 2021 (4 days, 3 hours) Not ideal and I have no idea how long the password is. Now the thing with this challenge was, I had no idea how long the password would be so I was trying all sorts of things with previous passwords from the CTF. Previous passwords were Afr1ca!, AfricanCTF2021 and ctf2021. So as you can see, there could be a pattern, so I tried a few mutations on those words but nothing came back. I hit a brickwall. A hint came out and it was basically said to use rules with dictionaries or masking. The masking was pretty much explained as, passwords usually start with an uppercase, ends with a ! and most times end with the 2nd last and 3rd last characters are lowercase and it seemed like it was hinted that the password was 8 characters long. So with that in mind, you could do the following mask: 1 hashcat -m 13600 -a 3 password.hash ?u?a?a?a?a?l?l! For me this would take a month to crack and this challenge only less than a week left! Back to the drawing board. Luckily, I knew someone, thanks NeonPegasus, with a beefy GPU so I asked them to throw it against that and see how long it would take to bruteforce. 1 (6 hours, 2 mins) I want that GPU! I wasn’t going to wait so I thought about this logically as a typical user and thought, what do we as humans do with passwords? We repeat passwords but just add or change a certain aspect of it. e.g Rover21April –&gt; Rover21May What if I used the same thinking to this challenge? Break down the passwords seen into smaller chunks, and from the hints given, prepend or append them to a dictionary? e.g Afr1can AfricanCTF2021 ctf2021 to Afr1can African CTF 2021 ctf So I did some reading and I found how to prepend and append these to another wordlist. Now before I embarrass myself, the method I used does work, to a certain degree, BUT because it kinda worked, I completely missed another attack mode that hashcat has to make this much simpler…but so we learn. Anyway, so I created a rules file to prepend them to rockyou.txt. My rules file looked like this: 1 2 3 4 5 ^n^a^c^1^r^f^A ^n^a^c^i^r^f^A ^f^t^c ^F^T^C ^1^2^0^2 It may look weird but this is how prepend works in hashcat. The char ^ is the prepend function. Say there is a word, dog, in the rockyou.txt file. You want to prepend the word cat to it. Your rule would look like ^t^a^c. So from left to right, hashcat will start with ^t and prepend it to dog making it tdog. The next one would be ^a and prepend that to tdog making it atdog. ^c prepends to atdog making it catdog. Done. Append works the other way. You have the word dog and you want to append cat to it. Your rule would be ^c^a^t, thus ^c appends to dog making it dogc, ^a appends to dogc making it dogca and finally ^t appends to dogca making it dogcat. Simple. So to use your rule file against a dictionary you would use the following: 1 hashcat -m 1000 -a 0 password.hash -r rule.file rockyou.txt So what I did was prepend the rules to rockyou.txt 1 2 Time.Estimated...: (56 mins, 9 secs) Status...........: Cracked I was baffled as to why I could not do words with the rules method so I took to our Hack South discord server and asked the question. With it being late Friday afternoon and a busy week behind me, someone mentioned why not just use the combinator attack. Wait what, how did I miss that, thanks Leon! So essentially I could have just put those words in a file and run: 1 hashcat -m 13600 -a 1 password.hash words.file rockyou.txt I felt stupid but then again, I actually learned how to do it the hard way and learned so much more about hashcat rules. ;-)","headline":"hashcat prepend rules the hard way","image":"https://0x.3n0.us/assets/img/img/hashcat.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://0x.3n0.us/hashcat-prepend-rules/"},"url":"https://0x.3n0.us/hashcat-prepend-rules/"}</script> <script src="//darksec.or.id/comments/dist/Valine.min.js"></script><title>hashcat prepend rules the hard way | 0x3n0</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="0x3n0"><meta name="application-name" content="0x3n0"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">0x3n0</a></div><div class="site-subtitle font-italic">Researcher | Pentester</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/Whoami/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>WHOAMI</span> </a><li class="nav-item"> <a href="/revershell/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>REVERSHELL</span> </a><li class="nav-item"> <a href="/OSINT/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>OSINT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://twitter.com/0x3n0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/0x3n0" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://instagram.com/0x3n0" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://app.hackthebox.com/profile/381523" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>hashcat prepend rules the hard way</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>hashcat prepend rules the hard way</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> mooncakeza </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, May 31, 2021, 9:30 AM +0700" >May 31, 2021<i class="unloaded">2021-05-31T09:30:00+07:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Jan 7, 2022, 5:01 PM +0900" >Jan 7<i class="unloaded">2022-01-07T15:01:48+07:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1064 words">5 min read</span></div></div><div class="post-content"><p> So on a recent CTF challenge I had to crack a hash which proved to be a bit challenging. I have always cracked hashes with dictionaries like the famous rockyou.txt. That's the problem with most CTFs, most are not real world scenarios.</p><p>Now this CTF was a bit different. It required more than just a dictionary. It required you to either use masking or rules against dictionaries. <br /> But of course I first ran it through rockyou.txt (14 million passwords) and I even ran it through another password file, weakpass_2a (7.8 billion passwords) and guess what, it didn’t crack the hash. <br /> Next step was to pretty much bruteforce it. hashcat has a bruteforce mode where you can throw every character at it to try crack it. The problem is, the longer the word, the longer it takes to crack. Another factor is, hashcat uses either youir CPU or GPU, so the power you have also inluences the cracking speed. I am not going to go into detail with this but this is something to keep in mind. <br /> Passwords are compromised of either uppercase, lowercase, digits, special characters or other different charsets. Another thing is the length of the password. So taking this into account you have to pretty much figure out how to attack it. One of the easiest, but costly ways is to use all charsets. <br /> These charsets correspond with the following masks in hashcat: <br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>?l - lowercase alphabet [a-z]
?u - uppercase alphabet [A-Z]
?d - digits [0-9]
?s - special characters
?a - all characters
</pre></table></code></div></div><p><br /> So let’s look at the following: <br /> You want to crack a hash but you have no idea on how many characters are in it or what characters they are. We can use the all characters mask but do keep in mind that the more you try the longer it will take. I usually can only do 5 due to my hardware resources. 6 characters would take me a year to crack. <br /> For this I could use the following command to try brute forcing from 1 character to 5 character password. (You can set the max increment value to what you want but remember it will take much longer the higher you go) <br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat -m 1000 -a 3 password.hash -i --increment-min 1 --increment-max 5 ?a?a?a?a?a?
</pre></table></code></div></div><p><br /> This would take me: <br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Time.Estimated...: Wed Jun  2 00:56:12 2021 (4 days, 3 hours)
</pre></table></code></div></div><p>Not ideal and I have no idea how long the password is. <br /> Now the thing with this challenge was, I had no idea how long the password would be so I was trying all sorts of things with previous passwords from the CTF. Previous passwords were Afr1ca!, AfricanCTF2021 and ctf2021. So as you can see, there could be a pattern, so I tried a few mutations on those words but nothing came back. I hit a brickwall. <br /> A hint came out and it was basically said to use rules with dictionaries or masking. The masking was pretty much explained as, passwords usually start with an uppercase, ends with a ! and most times end with the 2nd last and 3rd last characters are lowercase and it seemed like it was hinted that the password was 8 characters long. So with that in mind, you could do the following mask: <br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat -m 13600 -a 3 password.hash ?u?a?a?a?a?l?l!
</pre></table></code></div></div><p><br /> For me this would take a month to crack and this challenge only less than a week left! Back to the drawing board. Luckily, I knew someone, thanks NeonPegasus, with a beefy GPU so I asked them to throw it against that and see how long it would take to bruteforce. <br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(6 hours, 2 mins)
</pre></table></code></div></div><p><br /> I want that GPU! <br /> I wasn’t going to wait so I thought about this logically as a typical user and thought, what do we as humans do with passwords? We repeat passwords but just add or change a certain aspect of it. e.g Rover21April –&gt; Rover21May <br /> What if I used the same thinking to this challenge? Break down the passwords seen into smaller chunks, and from the hints given, prepend or append them to a dictionary? <br /> e.g Afr1can AfricanCTF2021 ctf2021 to Afr1can African CTF 2021 ctf <br /> So I did some <a href="https://hashcat.net/wiki/doku.php?id=rule_based_attack">reading</a> and I found how to prepend and append these to another wordlist. Now before I embarrass myself, the method I used does work, to a certain degree, BUT because it kinda worked, I completely missed another attack mode that hashcat has to make this much simpler…but so we learn. <br /> Anyway, so I created a rules file to prepend them to rockyou.txt. <br /> My rules file looked like this: <br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>^n^a^c^1^r^f^A
^n^a^c^i^r^f^A
^f^t^c
^F^T^C
^1^2^0^2
</pre></table></code></div></div><p><br /> It may look weird but this is how prepend works in hashcat. The char ^ is the prepend function. <br /> Say there is a word, dog, in the rockyou.txt file. You want to prepend the word cat to it. Your rule would look like ^t^a^c. So from left to right, hashcat will start with ^t and prepend it to dog making it tdog. The next one would be ^a and prepend that to tdog making it atdog. ^c prepends to atdog making it catdog. Done. <br /> Append works the other way. You have the word dog and you want to append cat to it. Your rule would be ^c^a^t, thus ^c appends to dog making it dogc, ^a appends to dogc making it dogca and finally ^t appends to dogca making it dogcat. Simple. <br /> So to use your rule file against a dictionary you would use the following: <br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat -m 1000 -a 0 password.hash -r rule.file rockyou.txt
</pre></table></code></div></div><p><br /> So what I did was prepend the rules to rockyou.txt <br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Time.Estimated...: (56 mins, 9 secs)
Status...........: Cracked
</pre></table></code></div></div><p><br /> I was baffled as to why I could not do words with the rules method so I took to our <a href="https://hacksouth.africa">Hack South</a> discord server and asked the question. With it being late Friday afternoon and a busy week behind me, someone mentioned why not just use the <a href="https://hashcat.net/wiki/doku.php?id=combinator_attack">combinator attack</a>. Wait what, how did I miss that, thanks Leon! <br /> So essentially I could have just put those words in a file and run: <br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat -m 13600 -a 1 password.hash words.file rockyou.txt
</pre></table></code></div></div><p><br /> I felt stupid but then again, I actually learned how to do it the hard way and learned so much more about hashcat rules. ;-)</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blog/'>blog</a>, <a href='/categories/hashcat/'>hashcat</a>, <a href='/categories/howto/'>howto</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hashcat/" class="post-tag no-text-decoration" >hashcat</a> <a href="/tags/passwords/" class="post-tag no-text-decoration" >passwords</a> <a href="/tags/cracking/" class="post-tag no-text-decoration" >cracking</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://0x3n0.us"> 0x3n0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=hashcat prepend rules the hard way - 0x3n0&url=https://0x.3n0.us/hashcat-prepend-rules/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=hashcat prepend rules the hard way - 0x3n0&u=https://0x.3n0.us/hashcat-prepend-rules/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=hashcat prepend rules the hard way - 0x3n0&url=https://0x.3n0.us/hashcat-prepend-rules/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://0x.3n0.us/hashcat-prepend-rules/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="http://service.weibo.com/share/share.php?title=hashcat prepend rules the hard way - 0x3n0&url=https://0x.3n0.us/hashcat-prepend-rules/" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <a href="https://lineit.line.me/share/ui?url=https://0x.3n0.us/hashcat-prepend-rules/&text=hashcat prepend rules the hard way - 0x3n0" data-toggle="tooltip" data-placement="top" title="Line" target="_blank" rel="noopener" aria-label="Line"> <i class="fa-fw iconfont icon-13"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/lack-of-resources-&-rate-limiting/">OWASP API Security Lack of Resources & Rate Limiting</a><li><a href="/cyberwarfare/">The invisible war</a><li><a href="/Postman-Writeup/">Postman Writeup</a><li><a href="/Traverxec-Writeup/">Traverxec Writeup</a><li><a href="/Resolute-Writeup/">Resolute Writeup</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/oscp-prep/">oscp-prep</a> <a class="post-tag" href="/tags/htb-linux-easy/">htb-linux-easy</a> <a class="post-tag" href="/tags/htb-windows-easy/">htb-windows-easy</a> <a class="post-tag" href="/tags/reverse-shell/">reverse-shell</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/programming/">Programming</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div class="post-navigation d-flex justify-content-between"> <a href="/cyber-apocalypse-ctf-minefield/" class="btn btn-outline-primary" prompt="Older"><p>Cyber Apocalypse CTF 2021 - Minefield (Pwn)</p></a> <a href="/FunboxEasyEnum-Writeup/" class="btn btn-outline-primary" prompt="Newer"><p>FunboxEasyEnum Writeup</p></a></div><div id="vcomments"></div><script> new Valine({ el: '#vcomments', appId: 'FWkEX16hdTMRmYzFQeIqS4GH-MdYXbMMI', appKey: 'ihjgIDYfMOWOfiX7hkrQrGXR', placeholder:'Your Comments.', avatar: 'wavatar', lang: 'en', enableQQ: true }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"> <a href="https://twitter.com/0x3n0?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-size="large" data-dnt="true" data-show-count="false">Follow @0x3n0</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><script src="https://www.hackthebox.com/badge/381523"></script></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/oscp-prep/">oscp prep</a> <a class="post-tag" href="/tags/htb-linux-easy/">htb linux easy</a> <a class="post-tag" href="/tags/htb-windows-easy/">htb windows easy</a> <a class="post-tag" href="/tags/reverse-shell/">reverse shell</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/programming/">Programming</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
