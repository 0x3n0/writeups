<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="HackTheBox - Grandpa" /><meta property="og:locale" content="en" /><meta name="description" content="Writeups of only retired HTB machines are allowed. The machine in this article, named Grandpa, is retired." /><meta property="og:description" content="Writeups of only retired HTB machines are allowed. The machine in this article, named Grandpa, is retired." /><link rel="canonical" href="https://0x.3n0.us/htb-grandpa/" /><meta property="og:url" content="https://0x.3n0.us/htb-grandpa/" /><meta property="og:site_name" content="0x3n0" /><meta property="og:image" content="https://0x.3n0.us/assets/img/htb/machines/windows/easy/grandpa/Grandpa.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-10-23T00:34:46+07:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://0x.3n0.us/assets/img/htb/machines/windows/easy/grandpa/Grandpa.png" /><meta property="twitter:title" content="HackTheBox - Grandpa" /><meta name="twitter:site" content="@0x3n0" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-01-07T15:22:31+07:00","datePublished":"2021-10-23T00:34:46+07:00","description":"Writeups of only retired HTB machines are allowed. The machine in this article, named Grandpa, is retired.","headline":"HackTheBox - Grandpa","image":"https://0x.3n0.us/assets/img/htb/machines/windows/easy/grandpa/Grandpa.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://0x.3n0.us/htb-grandpa/"},"url":"https://0x.3n0.us/htb-grandpa/"}</script> <script src="//darksec.or.id/comments/dist/Valine.min.js"></script><title>HackTheBox - Grandpa | 0x3n0</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="0x3n0"><meta name="application-name" content="0x3n0"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">0x3n0</a></div><div class="site-subtitle font-italic">Researcher | Pentester</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/Whoami/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>WHOAMI</span> </a><li class="nav-item"> <a href="/revershell/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>REVERSHELL</span> </a><li class="nav-item"> <a href="/OSINT/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>OSINT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://twitter.com/0x3n0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/0x3n0" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://instagram.com/0x3n0" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://app.hackthebox.com/profile/381523" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox - Grandpa</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox - Grandpa</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> 0x3n0 </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Oct 23, 2021, 12:34 AM +0700" >Oct 23, 2021<i class="unloaded">2021-10-23T00:34:46+07:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Jan 7, 2022, 5:22 PM +0900" >Jan 7<i class="unloaded">2022-01-07T15:22:31+07:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1365 words">7 min read</span></div></div><div class="post-content"><p><code class="language-plaintext highlighter-rouge">HTB</code> is an excellent platform that hosts machines belonging to multiple OS. It also has some other challenges as well. Individuals have to solve the puzzle (simple enumeration plus pentest) in order to log into the platform and download the VPN pack to connect to the machines hosted on the HTB platform.</p><p>Today we are going to solve another <code class="language-plaintext highlighter-rouge">CTF challenge</code> <kbd>Grandpa</kbd> which is lab presented by Hack the Box for making online penetration practices according to your experience level. They have a collection of vulnerable labs as challenges from beginners to Expert level. HTB has two partitions of lab i.e. Active and retired since we can’t submit write up of any Active lab, therefore, we have chosen retried Grandpa Lab.</p><h2 id="enumeration">Enumeration</h2><p>As usual, we’ll start by running the AutoRecon recon tool by <kbd>Tib3rius</kbd> on Grandpa. I highly recommend this tool to save time on CTF exams and practice. Navigate to the folder you downloaded and run the python script with our target IP. We will then go into our folder with the scan results completed and see the output of Nmap where we can start formulating theory for our exploit phase.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">cd </span>AutoRecon
./autorecon.py 10.10.10.14

<span class="nb">cd </span>AutoRecon/results/10.10.10.14/scans
</pre></table></code></div></div><p>If you wish to scan Grandpa without <code class="language-plaintext highlighter-rouge">AutoRecon</code>, I would recommend the below nmap scan which will achieve the same results without the subscripts.</p><h3 id="nmap-scan">nmap scan</h3><p>The only open port is port 80, running <strong>Microsoft IIS 6.0</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-sU</span> <span class="nt">-oN</span> UDP-scan.txt 10.10.10.14 &amp;
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-08-13 21:55 CEST
Nmap scan report <span class="k">for </span>10.10.10.14
Host is up <span class="o">(</span>0.10s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65534 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Microsoft IIS httpd 6.0
| http-methods: 
|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH
|_http-server-header: Microsoft-IIS/6.0
|_http-title: Under Construction
| http-webdav-scan: 
|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH
|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK
|   Server Date: Fri, 13 Aug 2021 20:19:10 GMT
|   WebDAV <span class="nb">type</span>: Unknown
|_  Server Type: Microsoft-IIS/6.0
Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows
</pre></table></code></div></div><p>I decided to perform an agressive scan and look for vulnerabilities with <kbd>nmap</kbd>`:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-vvv</span> <span class="nt">--script</span> vuln <span class="nt">-oN</span> vuln-scan.txt 10.10.10.14
PORT   STATE SERVICE REASON
80/tcp open  http    syn-ack ttl 127
|_http-csrf: Couldn<span class="s1">'t find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn'</span>t find any DOM based XSS.
| http-enum: 
|   /postinfo.html: Frontpage file or folder
|   /_vti_bin/_vti_aut/author.dll: Frontpage file or folder
|   /_vti_bin/_vti_aut/author.exe: Frontpage file or folder
|   /_vti_bin/_vti_adm/admin.dll: Frontpage file or folder
|   /_vti_bin/_vti_adm/admin.exe: Frontpage file or folder
|   /_vti_bin/fpcount.exe?Page<span class="o">=</span>default.asp|Image<span class="o">=</span>3: Frontpage file or folder
|   /_vti_bin/shtml.dll: Frontpage file or folder
|_  /_vti_bin/shtml.exe: Frontpage file or folder
| http-frontpage-login: 
|   VULNERABLE:
|   Frontpage extension anonymous login
|     State: VULNERABLE
|       Default installations of older versions of frontpage extensions allow anonymous logins which can lead to server compromise.
|       
|     References:
|_      http://insecure.org/sploits/Microsoft.frontpage.insecurities.html
|_http-iis-webdav-vuln: WebDAV is ENABLED. No protected folder found<span class="p">;</span> check not run. If you know a protected folder, add <span class="nt">--script-args</span><span class="o">=</span><span class="nv">webdavfolder</span><span class="o">=</span>&lt;path&gt;
</pre></table></code></div></div><h3 id="port-80-microsoft-iis-60">Port 80 (Microsoft IIS 6.0)</h3><p><strong>Microsoft IIS 6.0</strong> is for <strong>Windows Server 2003</strong>:</p><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/grandpa/IIS_Versions.png" alt="Desktop View" /></p><h4 id="gobuster">gobuster</h4><p>Gobuster is a tool used to brute-force <code class="language-plaintext highlighter-rouge">URI</code> including directories and files as well as DNS.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://10.10.10.14 <span class="nt">-w</span> /usr/share/wordlists/seclists/Discovery/Web-Content/co
mmon.txt <span class="nt">-x</span> .txt <span class="nt">-o</span> services/80-http.txt

<span class="o">===============================================================</span>
/Images               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 149] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.10.14/Images/]
/_private             <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 1529]
/_vti_bin             <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 155] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.10.14/%5Fvti%5Fbin/]
/_vti_cnf             <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 1529]
/_vti_bin/shtml.dll   <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 96]
/_vti_log             <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 1529]
/_vti_bin/_vti_adm/admin.dll <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 195]
/_vti_bin/_vti_aut/author.dll <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 195]
/_vti_pvt             <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 1529]
/_vti_txt             <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 1529]
/aspnet_client        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 218]
/images               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 149] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.10.14/images/]
<span class="o">===============================================================</span>
</pre></table></code></div></div><h4 id="nikto">nikto</h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nikto <span class="nt">-h</span> <span class="nv">$TARGET</span> <span class="nt">-output</span> services/80-nikto.txt
- Nikto v2.1.6
<span class="nt">---------------------------------------------------------------------------</span>
+ Target IP:          10.10.10.14
+ Target Hostname:    10.10.10.14
+ Target Port:        80
+ Start Time:         2021-10-23 22:11:52 <span class="o">(</span>GMT2<span class="o">)</span>
<span class="nt">---------------------------------------------------------------------------</span>
+ Server: Microsoft-IIS/6.0
+ Retrieved microsoftofficewebserver header: 5.0_Pub
+ Retrieved x-powered-by header: ASP.NET
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ Uncommon header <span class="s1">'microsoftofficewebserver'</span> found, with contents: 5.0_Pub
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site <span class="k">in </span>a different fashion to the MIME <span class="nb">type</span>
+ Retrieved x-aspnet-version header: 1.1.4322
+ No CGI Directories found <span class="o">(</span>use <span class="s1">'-C all'</span> to force check all possible <span class="nb">dirs</span><span class="o">)</span>
+ Retrieved dasl header: &lt;DAV:sql&gt;
+ Retrieved dav header: 1, 2
+ Retrieved ms-author-via header: MS-FP/4.0,DAV
+ Uncommon header <span class="s1">'ms-author-via'</span> found, with contents: MS-FP/4.0,DAV
+ Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH 
+ OSVDB-5646: HTTP method <span class="o">(</span><span class="s1">'Allow'</span> Header<span class="o">)</span>: <span class="s1">'DELETE'</span> may allow clients to remove files on the web server.
+ OSVDB-397: HTTP method <span class="o">(</span><span class="s1">'Allow'</span> Header<span class="o">)</span>: <span class="s1">'PUT'</span> method could allow clients to save files on the web server.
+ OSVDB-5647: HTTP method <span class="o">(</span><span class="s1">'Allow'</span> Header<span class="o">)</span>: <span class="s1">'MOVE'</span> may allow clients to change file locations on the web server.
+ Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH 
+ OSVDB-5646: HTTP method <span class="o">(</span><span class="s1">'Public'</span> Header<span class="o">)</span>: <span class="s1">'DELETE'</span> may allow clients to remove files on the web server.
+ OSVDB-397: HTTP method <span class="o">(</span><span class="s1">'Public'</span> Header<span class="o">)</span>: <span class="s1">'PUT'</span> method could allow clients to save files on the web server.
+ OSVDB-5647: HTTP method <span class="o">(</span><span class="s1">'Public'</span> Header<span class="o">)</span>: <span class="s1">'MOVE'</span> may allow clients to change file locations on the web server.
+ WebDAV enabled <span class="o">(</span>PROPPATCH COPY UNLOCK MKCOL PROPFIND LOCK SEARCH listed as allowed<span class="o">)</span>
+ OSVDB-13431: PROPFIND HTTP verb may show the server<span class="s1">'s internal IP address: http://10.10.10.14/
+ OSVDB-396: /_vti_bin/shtml.exe: Attackers may be able to crash FrontPage by requesting a DOS device, like shtml.exe/aux.htm -- a DoS was not attempted.
+ OSVDB-3233: /postinfo.html: Microsoft FrontPage default file found.
+ OSVDB-3233: /_vti_inf.html: FrontPage/SharePoint is installed and reveals its version number (check HTML source for more information).
+ OSVDB-3500: /_vti_bin/fpcount.exe: Frontpage counter CGI has been found. FP Server version 97 allows remote users to execute arbitrary system commands, though a vulnerability in this version could not be confirmed. http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1376. http://www.securityfocus.com/bid/2252.
+ OSVDB-67: /_vti_bin/shtml.dll/_vti_rpc: The anonymous FrontPage user is revealed through a crafted POST.
/_vti_bin/_vti_adm/admin.dll: FrontPage/SharePoint file found.
+ 8015 requests: 0 error(s) and 27 item(s) reported on remote host
+ End Time:           2021-10-23 22:28:53 (GMT2) (1021 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
</span></pre></table></code></div></div><h4 id="davtest">davtest</h4><p>We saw earlier from the <kbd>nmap</kbd> scan that the target server is using the <strong>WebDav</strong> protocol and <strong>HTTP PUT</strong> method is allowed. This could potentially give us the ability to upload files.</p><p>We can check that with <code class="language-plaintext highlighter-rouge">davtest</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="nv">$ </span>davtest <span class="nt">--url</span> http://<span class="nv">$TARGET</span>
<span class="k">********************************************************</span>
 Testing DAV connection
OPEN            SUCCEED:                http://10.10.10.14
<span class="k">********************************************************</span>
NOTE    Random string <span class="k">for </span>this session: XVHfy6LGFmkc
<span class="k">********************************************************</span>
 Creating directory
MKCOL           FAIL
<span class="k">********************************************************</span>
 Sending <span class="nb">test </span>files
PUT     pl      FAIL
PUT     cgi     FAIL
PUT     shtml   FAIL
PUT     php     FAIL
PUT     txt     FAIL
PUT     jsp     FAIL
PUT     jhtml   FAIL
PUT     html    FAIL
PUT     asp     FAIL
PUT     cfm     FAIL
PUT     aspx    FAIL

<span class="k">********************************************************</span>
/usr/bin/davtest Summary:
</pre></table></code></div></div><p>Unfortunately, all tests failed.</p><h2 id="exploitation">Exploitation</h2><p>Assembling the pieces together, we can look for exploits using <code class="language-plaintext highlighter-rouge">metasploit</code>:</p><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/grandpa/msf.png" alt="Desktop View" /></p><p>Let’s try this exploit on the web server:</p><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/grandpa/meterpreter.png" alt="Desktop View" /></p><p>Nice! Now let’s try <code class="language-plaintext highlighter-rouge">post/multi/recon/local_exploit_suggester</code>:</p><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/grandpa/suggester.png" alt="Desktop View" /></p><p>The target appears to be vulnerable to multiple exploits.</p><p>Let’s migrate to another process before and then run the exploit:</p><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/grandpa/SYSTEM.png" alt="Desktop View" /></p><p>BOUM! We are <strong>SYSTEM</strong>! This machine was a piece of cake, it was predictable because it’s a very old server with known vulnerabilities that had patches available.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox-walkthroughs/'>Hackthebox walkthroughs</a>, <a href='/categories/windows/'>Windows</a>, <a href='/categories/easy/'>Easy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/microsoft-iis/" class="post-tag no-text-decoration" >Microsoft IIS</a> <a href="/tags/webdav/" class="post-tag no-text-decoration" >WebDav</a> <a href="/tags/davtest/" class="post-tag no-text-decoration" >davtest</a> <a href="/tags/metasploit/" class="post-tag no-text-decoration" >metasploit</a> <a href="/tags/meterpreter/" class="post-tag no-text-decoration" >meterpreter</a> <a href="/tags/suggester/" class="post-tag no-text-decoration" >suggester</a> <a href="/tags/ms14-070/" class="post-tag no-text-decoration" >MS14-070</a> <a href="/tags/htb-windows-easy/" class="post-tag no-text-decoration" >htb-windows-easy</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/oscp-prep/" class="post-tag no-text-decoration" >oscp-prep</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://0x3n0.us"> 0x3n0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox - Grandpa - 0x3n0&url=https://0x.3n0.us/htb-grandpa/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox - Grandpa - 0x3n0&u=https://0x.3n0.us/htb-grandpa/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HackTheBox - Grandpa - 0x3n0&url=https://0x.3n0.us/htb-grandpa/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://0x.3n0.us/htb-grandpa/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="http://service.weibo.com/share/share.php?title=HackTheBox - Grandpa - 0x3n0&url=https://0x.3n0.us/htb-grandpa/" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <a href="https://lineit.line.me/share/ui?url=https://0x.3n0.us/htb-grandpa/&text=HackTheBox - Grandpa - 0x3n0" data-toggle="tooltip" data-placement="top" title="Line" target="_blank" rel="noopener" aria-label="Line"> <i class="fa-fw iconfont icon-13"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/lack-of-resources-&-rate-limiting/">OWASP API Security Lack of Resources & Rate Limiting</a><li><a href="/cyberwarfare/">The invisible war</a><li><a href="/Postman-Writeup/">Postman Writeup</a><li><a href="/Traverxec-Writeup/">Traverxec Writeup</a><li><a href="/Resolute-Writeup/">Resolute Writeup</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/oscp-prep/">oscp-prep</a> <a class="post-tag" href="/tags/htb-linux-easy/">htb-linux-easy</a> <a class="post-tag" href="/tags/htb-windows-easy/">htb-windows-easy</a> <a class="post-tag" href="/tags/reverse-shell/">reverse-shell</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/programming/">Programming</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div class="post-navigation d-flex justify-content-between"> <a href="/htb-buff/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox - Buff</p></a> <a href="/email-security/" class="btn btn-outline-primary" prompt="Newer"><p>Mengenal Email Security</p></a></div><div id="vcomments"></div><script> new Valine({ el: '#vcomments', appId: 'FWkEX16hdTMRmYzFQeIqS4GH-MdYXbMMI', appKey: 'ihjgIDYfMOWOfiX7hkrQrGXR', placeholder:'Your Comments.', avatar: 'wavatar', lang: 'en', enableQQ: true }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"> <a href="https://twitter.com/0x3n0?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-size="large" data-dnt="true" data-show-count="false">Follow @0x3n0</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><script src="https://www.hackthebox.com/badge/381523"></script></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/oscp-prep/">oscp prep</a> <a class="post-tag" href="/tags/htb-linux-easy/">htb linux easy</a> <a class="post-tag" href="/tags/htb-windows-easy/">htb windows easy</a> <a class="post-tag" href="/tags/reverse-shell/">reverse shell</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/programming/">Programming</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
